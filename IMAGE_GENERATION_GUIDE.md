# 图像生成功能使用指南

## 概述

Forsion AI Studio 现在支持在对话中直接生成图像！无需切换模式或使用特殊界面，只需在聊天中输入绘图指令即可。

## 功能特性

- 🎨 **智能检测**: 自动识别绘图意图，支持中英文关键词
- 🔧 **多提供商**: 支持 OpenAI DALL-E 3、Stability AI 等多个图像生成服务
- 💬 **无缝集成**: 在正常对话流程中直接生成图像
- 🌓 **主题适配**: 完美支持亮色/暗色主题
- 📊 **使用统计**: 自动记录 API 使用情况

## 使用方法

### 1. 配置 API 密钥

在使用图像生成功能前，需要先配置 API 密钥：

1. 点击右上角的设置图标
2. 找到 "OpenAI" 配置项
3. 输入你的 OpenAI API 密钥
4. 保存设置

> **提示**: 如果你有其他图像生成服务的 API 密钥（如 Stability AI），也可以配置。系统会自动选择已配置的服务。

### 2. 触发图像生成

有三种方式可以触发图像生成：

#### 方式一：中文关键词

```
画一张图：一只可爱的小猫
生成图片：美丽的日落风景
绘制一幅：未来城市
帮我画一个机器人
给我画一朵玫瑰花
```

#### 方式二：英文关键词

```
draw a picture of a cute cat
generate an image of a sunset
create a photo of mountains
make an image of a robot
paint a picture of flowers
```

#### 方式三：命令前缀

```
/draw a beautiful landscape
/image cute puppies playing
/generate futuristic city
/paint abstract art
```

### 3. 查看生成结果

- 系统会显示"正在生成图像..."的提示
- 图像生成完成后会自动显示在对话中
- 生成的图像以圆角卡片形式展示，支持暗色模式
- 如果生成失败，会显示具体的错误信息

## 支持的图像生成服务

### OpenAI DALL-E 3

- **优点**: 高质量、理解能力强、支持复杂提示词
- **尺寸**: 1024x1024, 1792x1024, 1024x1792
- **质量**: standard（标准）、hd（高清）
- **配置**: 需要 OpenAI API 密钥

### Stability AI

- **优点**: 开源、灵活、多种尺寸选择
- **尺寸**: 多种尺寸可选
- **配置**: 需要 Stability AI API 密钥

## 示例

### 示例 1：生成可爱的动物

**输入**:
```
画一张图：一只戴着帽子的橘猫，坐在窗台上看着外面的雨
```

**结果**: 系统会生成一张符合描述的图像

### 示例 2：生成风景

**输入**:
```
/draw a serene mountain landscape at sunset with a lake reflection
```

**结果**: 生成日落时分的山景和湖面倒影

### 示例 3：生成艺术作品

**输入**:
```
生成图片：赛博朋克风格的未来城市，霓虹灯闪烁
```

**结果**: 生成赛博朋克风格的城市场景

## 提示词技巧

### 好的提示词特征

1. **具体描述**: 包含主体、环境、风格、色彩等细节
2. **清晰明确**: 避免模糊或矛盾的描述
3. **适当长度**: 不要太短也不要太长（建议 10-50 字）

### 示例对比

❌ **不好的提示词**:
```
画一张图
一只猫
风景
```

✅ **好的提示词**:
```
画一张图：一只橘色的猫咪在阳光下打盹，温暖的午后氛围
生成图片：壮丽的雪山风景，蓝天白云，前景有松树
绘制一幅：印象派风格的荷花池塘，莫奈风格
```

## 常见问题

### Q: 为什么提示"API密钥未配置"？

A: 需要在设置中配置 OpenAI API 密钥。点击右上角设置图标，找到 OpenAI 配置项，输入你的 API 密钥。

### Q: 生成图像需要多长时间？

A: 通常需要 10-30 秒，具体取决于网络状况和 API 服务器负载。

### Q: 生成的图像可以保存吗？

A: 可以！右键点击图像，选择"图片另存为"即可保存到本地。

### Q: 支持中文提示词吗？

A: 完全支持！系统会自动识别中文关键词，并将中文提示词发送给 API。

### Q: 生成失败怎么办？

A: 常见原因：
1. API 密钥未配置或无效
2. 网络连接问题
3. API 配额用尽
4. 提示词违反内容政策

检查错误消息，根据提示进行相应处理。

### Q: 可以生成多张图片吗？

A: 目前每次请求生成一张图片。如需多张，可以多次发送请求。

### Q: 图像生成会消耗 token 吗？

A: 是的，图像生成会消耗 API 配额。系统会自动记录使用情况（如果已登录）。

## 技术细节

### 关键词检测

系统使用正则表达式智能检测以下模式：

- 中文：画图、生成图片、绘制、帮我画、给我画
- 英文：draw、generate、create、make、paint
- 命令：/draw、/image、/generate、/paint

### API 调用流程

```
用户输入 → 意图检测 → 提取提示词 → 选择API → 调用生成 → 显示结果
```

### 错误处理

- API 密钥错误：提示配置密钥
- 网络错误：显示网络连接提示
- 内容违规：显示 API 返回的错误信息
- 所有错误都会更新到消息中，不中断用户体验

## 注意事项

1. **API 费用**: 图像生成通常需要付费，请注意 API 使用配额
2. **内容政策**: 遵守 API 提供商的内容政策，不要生成违规内容
3. **网络要求**: 需要稳定的网络连接，API 调用直接从浏览器发起
4. **CORS**: 某些 API 可能需要配置 CORS，如遇问题请联系管理员

## 更新日志

### v1.0.0 (2025-01-19)

- ✨ 首次发布图像生成功能
- 🎨 支持中英文关键词检测
- 🔧 集成 OpenAI DALL-E 3
- 🔧 集成 Stability AI
- 📊 自动记录 API 使用统计
- 🌓 支持亮色/暗色主题

## 反馈与支持

如有问题或建议，欢迎提交 Issue 或 Pull Request！




